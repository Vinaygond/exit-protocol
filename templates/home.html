{% extends 'base.html' %}

{% block title %}Exit Protocol - Wealth Preservation{% endblock %}

{% block landing_content %}
<style>
    /* Forensic / Legal Theme - Mobile Optimized */
    :root {
        --navy-dark: #0f172a;
        --navy-light: #1e293b;
        --gold-accent: #b45309;
        --text-secondary: #64748b;
        --bg-offwhite: #f8fafc;
    }
    
    html, body {
        overflow-x: hidden; /* STOP Horizontal Scroll */
    }

    body {
        font-family: 'Inter', sans-serif;
        background-color: var(--bg-offwhite);
        color: #334155;
    }

    .brand-font {
        font-family: 'Playfair Display', serif;
        letter-spacing: -0.5px;
    }

    /* Navbar */
    .navbar-landing {
        background: white;
        border-bottom: 1px solid #e2e8f0;
        padding: 1rem 0;
    }

    /* Hero Section */
    .hero-section {
        padding: 4rem 0; /* Reduced padding for mobile */
        background: white;
        border-bottom: 1px solid #e2e8f0;
        overflow: hidden; /* Contains the layout */
    }
    
    /* Calculator Card */
    .calc-card {
        background: var(--navy-dark);
        color: white;
        border-radius: 12px;
        padding: 2rem;
        /* Optimized shadow for mobile performance */
        box-shadow: 0 10px 20px -5px rgba(0,0,0,0.2); 
    }
    
    .btn-gold {
        background-color: var(--gold-accent);
        color: white;
        font-weight: 600;
        border: none;
        padding: 12px 28px;
        border-radius: 6px;
        transition: transform 0.1s;
    }
    .btn-gold:active {
        transform: scale(0.98);
    }

    .stat-card {
        background: white;
        border: 1px solid #e2e8f0;
        padding: 1.5rem;
        border-radius: 12px;
        height: 100%;
    }
    
    /* CRITICAL FIX: Chart Container */
    .chart-wrapper {
        position: relative;
        height: 300px; /* Force fixed height */
        width: 100%;
        margin: 0 auto;
    }
</style>

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-landing sticky-top">
    <div class="container">
        <a class="navbar-brand brand-font fw-bold text-dark fs-4" href="#">
            <i class="bi bi-shield-check text-warning me-2"></i>EXIT<span class="text-warning">PROTOCOL</span>
        </a>
        <div class="d-flex gap-2">
            <a href="{% url 'accounts:login' %}" class="btn btn-outline-dark btn-sm px-3 fw-medium">Log In</a>
            <a href="{% url 'accounts:register' %}" class="btn btn-dark btn-sm px-3 fw-bold">Start</a>
        </div>
    </div>
</nav>

<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center g-5">
            <div class="col-lg-6">
                <div class="d-inline-flex align-items-center border border-secondary rounded-pill px-3 py-1 mb-3">
                    <span class="badge bg-warning text-dark me-2">CONFIDENTIAL</span>
                    <span class="small text-muted text-uppercase fw-bold" style="font-size: 0.7rem;">High Asset Protection</span>
                </div>
                <h1 class="display-5 fw-bold mb-3 brand-font lh-sm text-dark">
                    Protecting Wealth in the <br>
                    <span class="text-warning">Age of Separation.</span>
                </h1>
                <p class="lead text-muted mb-4 fs-6">
                    Divorce is the single largest destroyer of personal net worth. 
                    The <strong>Exit Protocol</strong> is a forensic infrastructure for high-earners facing the 50% cliff.
                </p>
                <div class="d-grid d-md-flex gap-3">
                    <a href="{% url 'accounts:register' %}" class="btn btn-dark btn-lg shadow-sm">
                        Start Forensic Trace
                    </a>
                    <a href="#roi-calculator" class="btn btn-outline-secondary btn-lg">
                        Calculate Risk
                    </a>
                </div>
                <div class="mt-4 text-muted small">
                    <i class="bi bi-lock-fill me-1"></i> Bank-grade encryption. 100% Anonymous.
                </div>
            </div>
            
            <div class="col-lg-6">
                <!-- Visual Hook: The Threat Analysis -->
                <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
                    <div class="card-header bg-white border-bottom py-3 px-4">
                        <h6 class="fw-bold mb-0 text-dark">Asset Exposure Analysis</h6>
                    </div>
                    <div class="card-body p-4">
                        <!-- FIX: Wrapped in fixed container -->
                        <div class="chart-wrapper">
                            <canvas id="threatChart"></canvas>
                        </div>
                        
                        <div class="alert alert-warning mt-4 mb-0 border-0 bg-warning bg-opacity-10 text-dark d-flex align-items-start">
                            <i class="bi bi-exclamation-triangle-fill me-3 mt-1 flex-shrink-0"></i>
                            <div>
                                <strong>The "50% Cliff":</strong><br>
                                <span class="small">Without LIBR tracing, commingled assets are presumed marital property.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Pain Points / Validation -->
<section class="py-5 bg-light">
    <div class="container py-5">
        <div class="text-center mb-5">
            <h2 class="fw-bold brand-font text-dark">The Silent Struggle</h2>
            <p class="text-muted small">Analyzed from 50,000+ anonymous high-net-worth discussions.</p>
        </div>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="stat-card">
                    <div class="mb-3 text-danger"><i class="bi bi-graph-down-arrow fs-2"></i></div>
                    <h5 class="fw-bold text-dark">Asset Dissipation</h5>
                    <p class="text-muted small mb-0">"I built this company for 15 years. Is she really entitled to half of my future equity because of one joint account?"</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-card">
                    <div class="mb-3 text-warning"><i class="bi bi-chat-quote fs-2"></i></div>
                    <h5 class="fw-bold text-dark">Weaponized Comms</h5>
                    <p class="text-muted small mb-0">"One angry text message cost me custody leverage. I need a filter before I hit send."</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-card">
                    <div class="mb-3 text-primary"><i class="bi bi-eye-slash fs-2"></i></div>
                    <h5 class="fw-bold text-dark">Privacy Leaks</h5>
                    <p class="text-muted small mb-0">"She tracked my location and accessed my cloud storage. How do I go dark effectively?"</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ROI Calculator Section -->
<section id="roi-calculator" class="py-5 bg-white border-top">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center mb-5">
                <h2 class="fw-bold brand-font text-dark">The Cost of Ignorance</h2>
                <p class="text-muted">Why an investment in forensic data creates 10,000% ROI.</p>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-7">
                <div class="calc-card">
                    <label class="form-label text-warning fw-bold small text-uppercase mb-2">Estimated Net Worth</label>
                    <div class="input-group input-group-lg mb-4">
                        <span class="input-group-text bg-dark border-secondary text-white border-end-0">$</span>
                        <input type="number" id="netWorthInput" class="form-control bg-dark text-white border-secondary border-start-0" value="500000" placeholder="500000">
                    </div>
                    
                    <button onclick="calculateROI()" class="btn btn-warning w-100 btn-lg fw-bold mb-4 shadow-sm">
                        Calculate Potential Loss
                    </button>
                    
                    <div id="resultsArea" class="pt-4 border-top border-secondary d-none">
                        <div class="row text-center g-3">
                            <div class="col-6 border-end border-secondary">
                                <small class="text-white-50 d-block mb-1 text-uppercase" style="font-size: 0.7rem;">Unprotected Loss</small>
                                <h3 class="text-danger fw-bold mb-0 fs-4" id="lossValue">$-</h3>
                            </div>
                            <div class="col-6">
                                <small class="text-white-50 d-block mb-1 text-uppercase" style="font-size: 0.7rem;">Protocol Savings</small>
                                <h3 class="text-success fw-bold mb-0 fs-4" id="savingsValue">$-</h3>
                            </div>
                        </div>
                        <div class="text-center mt-4">
                            <div class="badge bg-success bg-opacity-25 text-success border border-success px-3 py-2">
                                PROJECTED ROI: 12,400%
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="bg-dark text-white-50 py-5 border-top border-secondary">
    <div class="container text-center">
        <h5 class="brand-font text-white mb-3">EXIT<span class="text-warning">PROTOCOL</span></h5>
        <p class="small opacity-75 mb-4">Advanced litigation support systems for capital preservation.</p>
        <div class="small">
            &copy; 2025 Exit Protocol. All rights reserved.
        </div>
    </div>
</footer>

{% endblock %}

{% block extra_js %}
<script>
    // Chart.js - The Threat Chart (Mobile Optimized)
    document.addEventListener('DOMContentLoaded', function() {
        const ctx = document.getElementById('threatChart').getContext('2d');
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Your Share', 'Spouse Share', 'Legal Fees'],
                datasets: [{
                    data: [40, 40, 20],
                    backgroundColor: ['#0f172a', '#cbd5e1', '#b45309'], 
                    borderWidth: 0,
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false, // Allows chart to fill the 300px container exactly
                cutout: '70%',
                plugins: {
                    legend: { 
                        position: 'bottom', 
                        labels: { 
                            usePointStyle: true, 
                            padding: 20,
                            font: { size: 11 } 
                        } 
                    }
                }
            }
        });
    });

    // ROI Calculator Logic
    function calculateROI() {
        const netWorth = parseFloat(document.getElementById('netWorthInput').value) || 0;
        
        const loss = netWorth * 0.50;
        const savings = netWorth * 0.05;
        
        document.getElementById('lossValue').innerText = "$" + loss.toLocaleString();
        document.getElementById('savingsValue').innerText = "$" + savings.toLocaleString();
        
        const results = document.getElementById('resultsArea');
        results.classList.remove('d-none');
    }
</script>
{% endblock %}


